<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JPM Silver Strategy Terminal v9.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;700&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: radial-gradient(circle at top right, #1e293b, #0f172a); min-height: 100vh; color: #f1f5f9; }
        .module-card { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(71, 85, 105, 0.5); border-radius: 20px; padding: 24px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); transition: transform 0.3s; }
        .module-card:hover { transform: translateY(-5px); }
        .input-group { display: flex; align-items: center; margin-bottom: 0.8rem; }
        .label-text { width: 45%; font-family: 'JetBrains Mono', monospace; font-weight: 700; font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; }
        .input-control { width: 55%; background: #020617; border: 1px solid #334155; color: #3b82f6; padding: 6px 10px; border-radius: 8px; font-family: 'JetBrains Mono', monospace; outline: none; font-size: 0.8rem; }
        .input-control:focus { border-color: #3b82f6; box-shadow: 0 0 10px rgba(59, 130, 246, 0.3); color: #fff; }
        
        .lang-switch-container { display: flex; align-items: center; gap: 8px; background: #020617; padding: 4px; border-radius: 12px; border: 1px solid #334155; }
        .lang-toggle-btn { padding: 4px 10px; border-radius: 8px; font-size: 10px; font-weight: 900; transition: all 0.3s; cursor: pointer; }
        .lang-toggle-btn.active { background: #3b82f6; color: white; box-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
        .lang-toggle-btn:not(.active) { color: #475569; }

        .nav-link { @apply bg-slate-900 border border-slate-700 text-slate-400 px-3 py-2 rounded-lg text-[9px] font-bold uppercase hover:bg-blue-600 hover:text-white transition-all text-center flex items-center justify-center; }
        .result-box { @apply mt-4 pt-4 border-t border-slate-700/50 text-center; }
        .status-badge { @apply text-lg font-mono mt-1 transition-all duration-500; }
        .time-label { @apply text-[9px] text-slate-500 mt-2 block font-mono italic; }
    </style>
</head>
<body class="p-4 md:p-12">

    <div class="max-w-6xl mx-auto">
        <div class="flex flex-col lg:flex-row justify-between items-center mb-8 gap-6">
            <div class="text-center lg:text-left">
                <div class="flex items-center gap-6 justify-center lg:justify-start mb-2">
                    <h1 class="text-4xl font-black italic tracking-tighter text-white">JPM <span class="text-blue-500">TERMINAL</span></h1>
                    <div class="lang-switch-container">
                        <div onclick="setLang('cn')" id="btn-cn" class="lang-toggle-btn active">ä¸­æ–‡</div>
                        <div onclick="setLang('en')" id="btn-en" class="lang-toggle-btn">EN</div>
                    </div>
                </div>
                <p id="sub-title" class="text-slate-500 text-[10px] font-mono uppercase tracking-[0.3em]">Institutional Strategy v9.0 Pro</p>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 w-full lg:w-auto">
                <a href="https://www.barchart.com/futures/commitment-of-traders/technical-charts/SI*0" target="_blank" class="nav-link">ğŸ“Š COT Data</a>
                <a href="https://www.tradingview.com/symbols/XAGUSD/" target="_blank" class="nav-link">ğŸ“ˆ Spot Price</a>
                <a href="https://www.tradingview.com/symbols/COMEX-SI1!/" target="_blank" class="nav-link">ğŸ“‰ Futures</a>
                <a href="https://www.cmegroup.com/clearing/operations-and-deliveries/registrar-reports.html" target="_blank" class="nav-link">ğŸ“¦ Vault PDF</a>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
            <div class="module-card">
                <div id="t1-head" class="text-blue-500 text-[10px] font-black uppercase mb-4 tracking-widest">01. COT Positions</div>
                <div class="input-group"><span id="t1-l1" class="label-text">Long Pos</span><input type="number" id="cotLong" class="input-control" oninput="saveAndCalc()"></div>
                <div class="input-group"><span id="t1-l2" class="label-text">Short Pos</span><input type="number" id="cotShort" class="input-control" oninput="saveAndCalc()"></div>
                <div class="input-group"><span class="label-text">Report Date</span><input type="date" id="cotDate" class="input-control" oninput="saveAndCalc()"></div>
                <div class="result-box">
                    <span id="t1-res" class="text-[9px] text-slate-500 font-bold uppercase">Net Position</span>
                    <div id="cotResult" class="status-badge text-slate-400">---</div>
                    <span id="cotTimeDisp" class="time-label">Updated: --</span>
                </div>
            </div>

            <div class="module-card">
                <div id="t2-head" class="text-amber-500 text-[10px] font-black uppercase mb-4 tracking-widest">02. Basis Analysis</div>
                <div class="input-group"><span id="t2-l1" class="label-text">XAG Spot</span><input type="number" step="0.0001" id="spotPrice" class="input-control" oninput="saveAndCalc()"></div>
                <div class="input-group"><span id="t2-l2" class="label-text">SI Futures</span><input type="number" step="0.0001" id="futuresPrice" class="input-control" oninput="saveAndCalc()"></div>
                <div class="input-group"><span class="label-text">Update Time</span><input type="time" id="basisTime" class="input-control" oninput="saveAndCalc()"></div>
                <div class="result-box">
                    <span id="t2-res" class="text-[9px] text-slate-500 font-bold uppercase">Premium Level</span>
                    <div id="basisResult" class="status-badge text-slate-400">---</div>
                    <span id="basisTimeDisp" class="time-label">Synced: --</span>
                </div>
            </div>

            <div class="module-card">
                <div id="t3-head" class="text-emerald-500 text-[10px] font-black uppercase mb-4 tracking-widest">03. Vault Monitor (JPM/Total)</div>
                <div class="input-group"><span class="label-text">Adjustment</span><input type="number" id="vAdj" class="input-control" placeholder="Registered Adj" oninput="saveAndCalc()"></div>
                <div class="input-group"><span class="label-text">Withdrawn</span><input type="number" id="vWit" class="input-control" oninput="saveAndCalc()"></div>
                <div class="input-group"><span class="label-text">Total Stocks</span><input type="number" id="vTotal" class="input-control" oninput="saveAndCalc()"></div>
                <div class="input-group"><span class="label-text">CME Date</span><input type="date" id="vaultDate" class="input-control" oninput="saveAndCalc()"></div>
                <div class="result-box">
                    <span id="t3-res" class="text-[9px] text-slate-500 font-bold uppercase">Vault Status</span>
                    <div id="vaultResult" class="status-badge text-slate-400">---</div>
                    <span id="vaultTimeDisp" class="time-label">Report: --</span>
                </div>
            </div>
        </div>

        <div class="bg-slate-900 border-l-8 border-blue-600 p-8 rounded-r-3xl shadow-2xl relative mb-8">
            <div class="flex flex-col md:flex-row gap-8 items-center">
                <div id="indicator" class="w-20 h-20 bg-slate-800 rounded-2xl flex items-center justify-center text-3xl border border-slate-700 shadow-inner">ğŸ“¡</div>
                <div class="flex-1 space-y-2">
                    <h4 id="diag-head" class="text-blue-500 text-[10px] font-black uppercase tracking-[0.2em]">Strategy AI Core Diagnostic</h4>
                    <div id="finalAnalysis" class="text-2xl font-bold text-slate-300 leading-tight">AWAITING DATA...</div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 opacity-40 hover:opacity-100 transition-opacity">
            <div class="text-[10px] font-mono text-slate-500 border border-slate-800 p-3 rounded-lg">
                â— COT Update: Every Friday 15:30 EST (Weekly) <br>
                â— å ±å‘Šé »ç‡ï¼šæ¯é€±å…­å‡Œæ™¨æ›´æ–°ï¼Œæ•¸æ“šæ»¯å¾Œ 3 å¤©ã€‚
            </div>
            <div class="text-[10px] font-mono text-slate-500 border border-slate-800 p-3 rounded-lg">
                â— CME Vault: Daily after 15:00 EST <br>
                â— å ±å‘Šé »ç‡ï¼šæ¯å€‹å·¥ä½œæ—¥æ›´æ–°ï¼Œå¯¦é«”å¸‚å ´é ˜å…ˆæŒ‡æ¨™ã€‚
            </div>
        </div>
    </div>

    <script>
        let currentLang = 'cn';
        const i18n = {
            cn: {
                msgSqueeze: "ğŸš€ <span class='text-blue-400'>æ¥µç«¯è­¦å‘Šï¼š</span>é«˜æº¢åƒ¹ + é–å€‰ã€‚è»‹ç©ºå•Ÿå‹•ï¼",
                msgOutflow: "ğŸš¨ <span class='text-red-500'>å¯¦é«”æ“ å…Œï¼š</span>é‡‘åº«å–®æ—¥æè²¨å·¨å¤§ï¼Œä¾›æ‡‰æ–·è£‚ï¼",
                msgNeutral: "å¸‚å ´ç›¤æ•´ã€‚ç¾è²¨æº¢åƒ¹ç›®å‰ç‚º $",
                lock: "é–å€‰è“„å‹¢", outflow: "å¯¦é«”å¤±è¡€", pHigh: " (æ¥µç«¯æº¢åƒ¹)", pNormal: " (æ­£å¸¸)"
            },
            en: {
                msgSqueeze: "ğŸš€ <span class='text-blue-400'>STRATEGIC SQUEEZE:</span> HIGH PREMIUM + LOCKING!",
                msgOutflow: "ğŸš¨ <span class='text-red-500'>VAULT RUN:</span> MASSIVE WITHDRAWAL. SHORTAGE!",
                msgNeutral: "CONSOLIDATING. BASIS AT $",
                lock: "LOCKING", outflow: "OUTFLOW", pHigh: " (EXTREME)", pNormal: " (NORMAL)"
            }
        };

        window.onload = function() {
            const savedData = JSON.parse(localStorage.getItem('jpmTerminalV9'));
            if (savedData) {
                Object.keys(savedData).forEach(key => {
                    const el = document.getElementById(key);
                    if (el) el.value = savedData[key];
                });
                currentLang = savedData.lang || 'cn';
            }
            setLang(currentLang);
        };

        function setLang(lang) {
            currentLang = lang;
            document.getElementById('btn-cn').classList.toggle('active', lang === 'cn');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');
            saveAndCalc();
        }

        function saveAndCalc() {
            const fields = ['cotLong', 'cotShort', 'cotDate', 'spotPrice', 'futuresPrice', 'basisTime', 'vAdj', 'vWit', 'vTotal', 'vaultDate'];
            const dataToSave = { lang: currentLang };
            fields.forEach(f => dataToSave[f] = document.getElementById(f).value);
            localStorage.setItem('jpmTerminalV9', JSON.stringify(dataToSave));

            // æ›´æ–°æ™‚é–“é¡¯ç¤º
            document.getElementById('cotTimeDisp').innerText = "Updated: " + (dataToSave.cotDate || "--");
            document.getElementById('basisTimeDisp').innerText = "Synced: " + (dataToSave.basisTime || "--");
            document.getElementById('vaultTimeDisp').innerText = "Report: " + (dataToSave.vaultDate || "--");

            calculate();
        }

        function calculate() {
            const cl = parseFloat(document.getElementById('cotLong').value) || 0;
            const cs = parseFloat(document.getElementById('cotShort').value) || 0;
            const net = cl - cs;
            const cotDiv = document.getElementById('cotResult');
            cotDiv.innerText = cl ? net.toLocaleString() : "---";
            cotDiv.style.color = net < -30000 ? '#ef4444' : '#3b82f6';

            const sp = parseFloat(document.getElementById('spotPrice').value) || 0;
            const fp = parseFloat(document.getElementById('futuresPrice').value) || 0;
            const diff = sp - fp;
            const basisDiv = document.getElementById('basisResult');
            if (fp > 0) {
                let pText = diff > 1.0 ? i18n[currentLang].pHigh : i18n[currentLang].pNormal;
                basisDiv.innerText = `$${diff.toFixed(2)}${pText}`;
                basisDiv.style.color = diff > 1.0 ? '#fbbf24' : '#94a3b8';
            } else { basisDiv.innerText = "---"; }

            const adj = parseFloat(document.getElementById('vAdj').value) || 0;
            const wit = parseFloat(document.getElementById('vWit').value) || 0;
            const tot = parseFloat(document.getElementById('vTotal').value) || 0;
            const vaultDiv = document.getElementById('vaultResult');
            
            if (tot > 0) {
                const totWan = (tot / 10000).toFixed(0);
                if (wit > 500000) { 
                    vaultDiv.innerText = i18n[currentLang].outflow + ` (${totWan}W)`; vaultDiv.style.color = "#ef4444";
                } else if (adj < 0) {
                    vaultDiv.innerText = i18n[currentLang].lock + ` (${totWan}W)`; vaultDiv.style.color = "#3b82f6";
                } else {
                    vaultDiv.innerText = totWan + (currentLang === 'cn' ? " è¬ç›å¸" : " W Oz");
                    vaultDiv.style.color = "#94a3b8";
                }
            } else { vaultDiv.innerText = "---"; }

            const analysis = document.getElementById('finalAnalysis');
            const indicator = document.getElementById('indicator');
            if (!cl || !sp) return;

            if (wit > 1000000) {
                analysis.innerHTML = i18n[currentLang].msgOutflow; indicator.innerText = "ğŸ”¥";
            } else if (diff > 1.2 && adj < 0) {
                analysis.innerHTML = i18n[currentLang].msgSqueeze; indicator.innerText = "ğŸš€";
            } else {
                analysis.innerHTML = i18n[currentLang].msgNeutral + diff.toFixed(2); indicator.innerText = "ğŸ“¡";
            }
        }
    </script>
</body>
</html>
